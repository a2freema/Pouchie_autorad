---
title: Oxytocin and Vasopressin Receptors in the Pouched Rat
author:
  - name: Samanta Arenas
    email: sa658@cornell.edu
    affiliation: Cornell University
  - name: Angela R. Freeman
    email: arf86@cornell.edu
    affiliation: Cornell University
  - name: Bhupinder Singh
    email: bs256@cornell.edu
    affiliation: Vetschool
  - name: Alexander G. Ophir
    email: ophir@cornell.edu
    affiliation: Cornell University
    footnote: 1
address:
  - code: Cornell University
    address: Cornell University, Department of Psychology, Ithaca, NY, 14853
  - code: Vetschool
    address: Cornell University, Department of Veterinary Medicine, Ithaca, NY, 14853
footnote:
  - code: 1
    text: "Corresponding Author"
abstract: |
  This is the abstract.
  It consists of two paragraphs.
journal: "Journal of Neuroscience"
date: "`r Sys.Date()`"
bibliography: library.bib
linenumbers: true
#numbersections: true
csl: elsevier-harvard.csl
geometry: margin=2cm
header-includes:
  - \usepackage{setspace}\doublespacing
output: rticles::elsevier_article
editor_options: 
  chunk_output_type: console
---
```{r, echo = FALSE}
# For this document to work well, I recommend that you have the packages citr, rticles installed and loaded.

# For more information on Rmarkdown, check out https://rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf

# The paths to the datafiles used for the manuscript need to be changed to where you have these files on your computer.

#The bibliography file should be in your project directory (where this Rmarkdown file is) for references to render properly.

#To 'track changes' see the syntax used here: http://criticmarkup.com/users-guide.php
# However, comments {>> This appears as a comment in rendering to word docs<<}
# are always welcome.

OTRdata <-read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad OTR FINAL.csv")
V1data <- read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad V1ar FINAL.csv")
OTRPCAdata <-read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad OTR PCA.csv")
V1PCAdata <-read.csv(file="C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad V1ar PCA.csv")

```



# Introduction 

The neuropeptides, oxytocin (OT) and vasopressin (VP), have receptor distributions in the brain that can modulate a variety of social behaviors such as parental care, affiliation, and aggression, among other behaviors [@caldwellOxytocinVasopressinMotivational2015]. The densities of their associated receptors, oxytocin (OTR) and vasopressin (V1aR and V1bR) receptors, are often species- and sex-dependent.
 

>- What do we know about the distribution and relative densities of receptors (i.e. what can it tell us, what’s been done on behavior?) 

>-How might life history differences play into patterning of central distribution of these receptors? 

>-What tends to be conserved? 

>-How does comparative analysis help? [@kellyComparedWhatWhat2015] 

>-Why did we do this study? What were we examining? 

>-We wanted to describe the presence and relative density of OTR and V1aR in pouched rat brains in males and females, to see if there were differences in presence and density between sexes 

>-We wanted to explore how the patterning of these receptors might differ from other rodents and see if it further supports the ideas found in the recent metaanalysis [@freemanComparisonDistributionOxytocin2020](see where pouched rats fall in this framework) 

 
 

# Methods 

All work with animals was approved under the U.S. Army Medical Research and Materiel Command (USAMRMC) Animal Care and Use Review Office (ACURO) and the Cornell Institutional Animal Care and Use Committee (IACUC 2014-0043). All tissues were collected from wild-caught animals from Morogoro, Tanzania (6&deg;49'49"S, 37&deg;40'14"E). Prior to collection, animals were housed individually in standard rabbit enclosures and maintained on a 12:12 h light:dark light cycle, at 21&deg;C and 45% humidity. Males and females were kept in separate rooms. Animals were fed a standard rodent diet supplemented with dog kibble and fresh fruit and vegetable treats. Bones, a metal 'stovepipe' hutch, and dog puzzle toys were given as behavioral enrichment.

Animals were euthanized via CO~2~ inhalation and brains were swiftly removed and frozen using liquid nitrogen or powdered dry ice and stored at -80&deg;C prior to sectioning. Ten male and ten female brains were used for this study. Brains were blocked coronally by removing the cerebellum, then split sagittally next to the midline into two hemispheres, and one hemisphere (preferably the left if unblemished) was coronally sectioned at 20µm thick using a Leica cryostat (CM1950) set at -20&deg;C. Due to the large size of the pouched rat brains, we mounted every 3rd section and kept 6 serial sets. Sections were collected from the olfactory bulbs to the start of the cerebellum, and mounted on Superfrost Plus Microscope sides (Fisher Scientific, Pittsburg, PA USA).

Microscope slides were stored at -80ºC until the autoradiography procedure.

On two of the sets of slides, we used ^125^I radioligands to label oxytocin receptor (ornithine vasopressin analog, ^125^I-OVTA); NEX 254, PerkinElmer; Waltham, MA) or vasopressin 1a receptor (vasopressin (Linear), V-1A antagonist (Phenylacetyl1, 0-Me-D-Tyr2 [ ^125^I-Arg6 ]-); NEX 310, PerkinElmer), as described by Ophir and colleagues [@ophirStabilityDynamicsForebrain2013]. Following processing and air-drying, we exposed radiolabeled tissue to film (Kodac,.....) for 6 days for OTR and 2 days for V1aR to account for differing degrees of decay at the time of use. In each film casette, we included two ^125^I microscales (American Radiolabeled Chemicals; St Louis, MO), to allow for the conversion of optical density to receptor density. We inferred that receptor density relates to optical density of exposed film to use optical measurements as a proxy for receptor density. We digitized films on a Microtek ArtixScan M1 (Microtek, Santa Fe Springs, CA) and measured optical densities using NIH ImageJ Software. We calculated receptor density by first converting optical density to disintegrations per minute (dpm), adjusted for tissue equivalence (TE; for 1 mg in the rat brain), by fitting curves generated by radiographic standards and extrapolating based on these standard curves for each film.

Three sequential sections were measured fo4r density by encircling the regions of interest using NIH ImageJ software. The software program calculated mean optical density values and area for regions of interest (ROI). We measured background labelling by measuring optical density from an area of cortex in the same section for each region of interest. To correctly identify ROI, we Nissl-stained a third set of tissue to use as a reference, in conjunction with anatomical landmarks identified using a Rat brain atlas. The three measurements for each individual's ROIs and background were averaged separately, and background was subtracted from the ROI to yield receptor density. These final measurements were used for all statistical tests, tables, and figures.

OTR density was measured in the olfactory bulb (OB), anterior olfactory nucleus (AON), prefrontal cortex (PFC), piriform cortex (Pir), nucleus accumbens (NAcc), lateral septum (LS), endopiriform (Den), claustrum (VCL), lateral bed nucleus of the stria terminalis (BSTl), medial bed nucleus of the stria terminalis (BSTm), ventral bed nucleus of the stria terminalis (BSTv), ventral pallidum (VPall), medial preoptic area (MPOA), anterior hypothalamus (AH), paraventricular thalamus (PVT), suprachiasmatic nucleus (SCN), paraventricular nucleus (PVN), magnocellular hypothalamic nucleus (MCPO), medial habenula (MHb), central amygdala (CeA), medial amygdala (MeA), basolateral amygdala (BLA), ventromedial hypothalamus (VMH), zona incerta (ZIR), lateral hypothalamus (PrFLH), hippocampal CA1, hippocampal CA2, hippocampal CA3, dentate gyrus (DG), premammilary ventral nucleus (PMV), ventral tegmental area (VTA), periaqueductal gray (PAG), medial geniculate (MG), superior colliculus (SuG), and the ventral CA3. V1aR was measured in the same regions except for the MCPO and the MHb.

To calculate 'relative binding' on a 4-point scale, we used the following definitions: mean OTR < 35 dpm/mg: absent/-, 35 to 490: present/+, 490 to 945: moderate/++, 945 to 1400: dense/+++; mean V1aR < 100 dpm/mg: absent/-, 100-1367: present/+, 1367 to 2634: moderate/++, 2634 to 3800: dense/+++. To compare receptor densities between sexes, we conducted t-tests for each region. Test statistics were considered significant when p < 0.05. 

We used the framework from Freeman et al. (2020) to compare pouched rat overall binding patterns to those in other rodents [@freemanComparisonDistributionOxytocin2020]. This framework uses overall OTR and V1aR binding patterns to examine similarities among species, genera, and family groups. Briefly, relative binding patterns within a species are converted to a 4-point scale, using wording and data from previously published studies. These data are then used in a principal components analysis, and species are plotted along the PC1 and PC2 components, with vectors in the plot serving as weights of each variable, and the direction indicating loading on PC1 and PC2. The pouched rat data point is then mapped onto this plot based on the data found in this study. In addition to superimposing the pouched rat onto the PCA biplot, we recreated the comparative permutational anova (Adonis function) to examine whether genus or family groups predicted similarities among species' relative binding patterns. All analyses were conducted in R 4.0.2, with the vegan package for the 'adonis' function, and stats package for t tests and principal components analysis [@rdevelopmentcoreteamLanguageEnvironmentStatistical2016]. PCA biplots were make using an adapted version of the ggbiplot function in the ggbiplot package, which allowed for altered color selection.

# Results 

```{r load packages set functions, echo=FALSE, results="hide", message=FALSE}
# load all necessary libraries ----
load_pkg <- rlang::quos(tidyverse, ade4, ade4TkGUI, exactRankTests, ggplot2, stargazer, ggthemes, lme4, lmerTest, emmeans, extrafont, car, corrplot, tidyverse, dplyr, ggpubr, osfr, broom, vegan)

invisible(lapply(lapply(load_pkg, rlang::quo_name),
  library,
  character.only = TRUE
))
#font_import() #if you haven't loaded and run extrafont package before

#
serr <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))

theme_alex <- function(base_size=24, base_family ="Arial") {
  theme_few() %+replace%
    theme(axis.ticks = element_blank(), legend.title=element_text(size=24, face="bold"), 
          axis.title=element_text(size=24,face="bold"),
          axis.line = element_line(colour = "black"),
          panel.border = element_blank(),
          legend.position = "right")
  
}

summary(OTRdata)
summary(V1data)

summary(lm(OB..final. ~ Sex, data=OTRdata))

# Run t-tests ----
t.test(OB..final. ~Sex, data=OTRdata)
t.test(AON..final. ~Sex, data=OTRdata)
t.test(mPFC..final. ~Sex, data=OTRdata)
t.test(mPFC..final..1 ~Sex, data=OTRdata)
t.test(Nacc..final. ~Sex, data=OTRdata)
t.test(Nacc..final..1 ~Sex, data=OTRdata)
t.test(Caudate.P..Final. ~Sex, data=OTRdata)
t.test(PirCtx..final. ~Sex, data=OTRdata)
t.test(LS.I..final. ~Sex, data=OTRdata)
t.test(LS.D..final. ~Sex, data=OTRdata)
t.test(LSV..final. ~Sex, data=OTRdata)
t.test(Endopir..final. ~Sex, data=OTRdata)
t.test(Claustrum..final. ~Sex, data=OTRdata)
t.test(BSTm..final. ~Sex, data=OTRdata)
t.test(BSTi..final. ~Sex, data=OTRdata)
t.test(BSTv..final. ~Sex, data=OTRdata)
t.test(Vpall..final. ~Sex, data=OTRdata)
t.test(MPOA..final. ~Sex, data=OTRdata)
t.test(AH..final. ~Sex, data=OTRdata)
t.test(PVT..final. ~Sex, data=OTRdata)
t.test(SCN..final. ~Sex, data=OTRdata)
t.test(PVN..final. ~Sex, data=OTRdata)
t.test(MHypNuc..final. ~Sex, data=OTRdata)
t.test(Med.Habenula..final. ~Sex, data=OTRdata)
t.test(CeA..final. ~Sex, data=OTRdata)
t.test(MeA..final. ~Sex, data=OTRdata)
t.test(BLA..final. ~Sex, data=OTRdata)
t.test(VMH..final. ~Sex, data=OTRdata)
t.test(Zona.Incert..final. ~Sex, data=OTRdata)
t.test(Lat.Hyp..final. ~Sex, data=OTRdata)
t.test(CA1..final. ~Sex, data=OTRdata)
t.test(CA2..final. ~Sex, data=OTRdata)
t.test(CA3..final. ~Sex, data=OTRdata)
t.test(DG..final. ~Sex, data=OTRdata)
t.test(Premamm..final. ~Sex, data=OTRdata)
t.test(VTA..final. ~Sex, data=OTRdata)
t.test(PAG..final. ~Sex, data=OTRdata)
t.test(Mgen..final. ~Sex, data=OTRdata)
scol.OT <- t.test(Scol..final. ~Sex, data=OTRdata)
t.test(Ventral.CA3..final. ~Sex, data=OTRdata)

t.test(OB..final. ~Sex, data=V1data)
t.test(AON..final. ~Sex, data=V1data)
t.test(mPFC..final. ~Sex, data=V1data)
t.test(mPFC..final..1 ~Sex, data=V1data)
t.test(Nacc..final. ~Sex, data=V1data)
t.test(Nacc..final..1 ~Sex, data=V1data)
t.test(Caudate.P..Final. ~Sex, data=V1data)
t.test(PirCtx..final. ~Sex, data=V1data)
t.test(LS.I..final. ~Sex, data=V1data)
t.test(LS.D..final. ~Sex, data=V1data)
t.test(LSV..final. ~Sex, data=V1data)
t.test(Endopir..final. ~Sex, data=V1data)
t.test(Claustrum..final. ~Sex, data=V1data)
t.test(BSTm..final. ~Sex, data=V1data)
t.test(BSTi..final. ~Sex, data=V1data)
t.test(BSTv..final. ~Sex, data=V1data)
t.test(Vpall..final. ~Sex, data=V1data)
t.test(MPOA..final. ~Sex, data=V1data)
t.test(AH..final. ~Sex, data=V1data)
t.test(PVT..final. ~Sex, data=V1data)
t.test(SCN..final. ~Sex, data=V1data)
t.test(PVN..final. ~Sex, data=V1data)
#t.test(MHypNuc..final. ~Sex, data=V1data)
#t.test(Med.Habenula..final. ~Sex, data=V1data)
t.test(CeA..final. ~Sex, data=V1data)
t.test(MeA..final. ~Sex, data=V1data)
t.test(BLA..final. ~Sex, data=V1data)
t.test(VMH..final. ~Sex, data=V1data)
t.test(Zona.Incert..final. ~Sex, data=V1data)
t.test(Lat.Hyp..final. ~Sex, data=V1data)
t.test(CA1..final. ~Sex, data=V1data)
t.test(CA2..final. ~Sex, data=V1data)
t.test(CA3..final. ~Sex, data=V1data)
t.test(DG..final. ~Sex, data=V1data)
t.test(Premamm..final. ~Sex, data=V1data)
t.test(VTA..final. ~Sex, data=V1data)
t.test(PAG..final. ~Sex, data=V1data)
t.test(Mgen..final. ~Sex, data=V1data)
t.test(Scol..final. ~Sex, data=V1data)
t.test(BSTv..final. ~Sex, data=V1data)
t.test(Ventral.CA3..final. ~Sex, data=V1data)
```

After comparing male and female densities in the measured regions, most regions showed no differences between sexes. The superior colliculus had higher densities of OTR in females compared to males (Female mean: `r round(scol.OT$estimate[1], digits= 2)`, Male mean `r round(scol.OT$estimate[2], digits = 2)`, t~(`r round(scol.OT$parameter, digits = 2)`)~ = `r round(scol.OT$statistic, digits = 2)`, p = `r round(scol.OT$p.value, digits = 2)`), however, this was no longer significant after corrections for multiple comparisons.


```{r pouchie ot data, echo=FALSE, results="hide"}
# graphing ----------------------------------------------------------------

# M <- cor(OTRPCAdata[,3:42], use="pairwise.complete.obs")
# warnings()
# corrplot(M, method="circle")
# OTR.pca <- prcomp(M)
# summary(OTR.pca)
# OTRPCAdata$ID <- as.factor(OTRPCAdata$ID)
# ggbiplot(OTR.pca, groups=OTRPCAdata$Sex, ellipse=T)

OTRPCAdatalong <- gather(OTRPCAdata, condition, measurement,  Olfactory.Bulb:Ventral.CA3, factor_key=T)
#head(OTRPCAdatalong)


# ggplot(OTRPCAdatalong, aes(x = Sex, y = measurement, group=condition, color=Sex, group=Sex)) +
#   geom_violin() +
#   facet_wrap(~ condition, ncol=4)
# 
```

\newpage
```{r OTR table, echo=FALSE, message=FALSE}
sum_OTdata <- OTRPCAdatalong %>% drop_na() %>%
    group_by(condition, Sex) %>%
    dplyr::summarize(density_mean = round(mean(measurement), digits = 2),
              density_serr = round(serr(measurement), digits = 2),
              n_datapoints =n()) %>%
  ungroup()

sum_OTdata$condition <- gsub("[.]", " ", sum_OTdata$condition) 
kable_OTcol2 <- paste(sum_OTdata$density_mean, "±", sum_OTdata$density_serr)

sum_OTdata2 <- sum_OTdata %>% select(-one_of("density_serr"), -one_of("density_mean"))  %>% add_column(kable_OTcol2, .before= "n_datapoints") %>% filter(condition !="Dentate Gyrus" & condition !="Medial Geniculate" & condition !="Ventral CA3")
                        
large_colnames <- c("Region", "Sex", "Density mean ± SE (dpm/mg)", "N")
knitr::kable(sum_OTdata2, col.names = large_colnames, align='llrr', caption="OTR densities by region and sex")
```
\newpage

```{r OTR relative table, echo=FALSE}
OTRcategory <- data.frame("Region" = c("Olfactory Bulb", "Nucleus Accumbens", "mPFC", "Ventral Pallidum", "Lateral Septum", "BST", "CeA", "MeA", "Hippocampus", "VMH", "VTA"), "Relative Binding" = c("+", "+", "+", "-", "+", "++", "++", "+", "+", "+++", "++"))

knitr::kable(OTRcategory, align='lc', caption="OTR relative densities in select regions")

```



```{r pouchie v1 data long, echo=FALSE, include=FALSE, fig.width= 4, fig.height=7}

V1PCAdatalong <- gather(V1PCAdata, condition, measurement, Olfactory.Bulb:Ventral.CA3, factor_key=T)
#head(V1PCAdatalong)
```

\newpage
```{r V1aR table, echo=FALSE, message=FALSE}
sum_data <- V1PCAdatalong %>% drop_na() %>%
    group_by(condition, Sex) %>%
    dplyr::summarize(density_mean = round(mean(measurement), digits = 2),
              density_serr = round(serr(measurement), digits = 2),
              n_datapoints =n()) %>%
  ungroup()

sum_data$condition <- gsub("[.]", " ", sum_data$condition) 
kable_col2 <- paste(sum_data$density_mean, "±", sum_data$density_serr)

sum_data2 <- sum_data %>% select(-one_of("density_serr"), -one_of("density_mean"))  %>% add_column(kable_col2, .before= "n_datapoints") %>% filter(condition !="CA1" & condition !="CA3")
                        
large_colnames <- c("Region", "Sex", "Density mean ± SE (dpm/mg)", "N")
knitr::kable(sum_data2, col.names = large_colnames, align='llrr', caption="V1aR densities by region and sex")
```
\newpage


```{r v1aR relative table, echo=FALSE}
V1rcategory <- data.frame("Region" = c("Olfactory Bulb", "Nucleus Accumbens", "mPFC", "Ventral Pallidum", "Lateral Septum", "BST", "CeA", "MeA", "PVN", "Hippocampus", "Dentate Gyrus", "Premammillary Nucleus", "VMH", "VTA"), "Relative Binding" = c("++", "++", "+", "+", "+++", "++", "++", "+", "+", "-", "+", "++", "+", "+"))

knitr::kable(V1rcategory, align='lc', caption="V1aR relative densities in select regions")

```



```{r ggbiplot function, echo=FALSE, results="hide"}

# GGbiplot function -------------------------------------------------------
#This function edited to make vector labels parallel and black.
#also new is option to flip x axis, which will nudge the vector labels too

ggbiplot <- function (pcobj, choices = 1:2, scale = 1, pc.biplot = TRUE, 
                      obs.scale = 1 - scale, var.scale = scale, groups = NULL, 
                      ellipse = FALSE, ellipse.prob = 0.68, labels = NULL, shapes = NULL, labels.size = 3, 
                      alpha = 1, var.axes = TRUE, circle = FALSE, circle.prob = 0.69, 
                      varname.size = 3, varname.adjust = 1.5, varname.abbrev = FALSE, flip.x = FALSE, flip.y =                        FALSE,
                      ...) 
{
  library(ggplot2)
  library(plyr)
  library(scales)
  library(grid)
  library(extrafont)
  stopifnot(length(choices) == 2)
  if (inherits(pcobj, "prcomp")) {
    nobs.factor <- sqrt(nrow(pcobj$x) - 1)
    d <- pcobj$sdev
    u <- sweep(pcobj$x, 2, 1/(d * nobs.factor), FUN = "*")
    v <- pcobj$rotation
  }
  else if (inherits(pcobj, "princomp")) {
    nobs.factor <- sqrt(pcobj$n.obs)
    d <- pcobj$sdev
    u <- sweep(pcobj$scores, 2, 1/(d * nobs.factor), FUN = "*")
    v <- pcobj$loadings
  }
  else if (inherits(pcobj, "PCA")) {
    nobs.factor <- sqrt(nrow(pcobj$call$X))
    d <- unlist(sqrt(pcobj$eig)[1])
    u <- sweep(pcobj$ind$coord, 2, 1/(d * nobs.factor), FUN = "*")
    v <- sweep(pcobj$var$coord, 2, sqrt(pcobj$eig[1:ncol(pcobj$var$coord), 
                                                  1]), FUN = "/")
  }
  else if (inherits(pcobj, "lda")) {
    nobs.factor <- sqrt(pcobj$N)
    d <- pcobj$svd
    u <- predict(pcobj)$x/nobs.factor
    v <- pcobj$scaling
    d.total <- sum(d^2)
  }
  else {
    stop("Expected a object of class prcomp, princomp, PCA, or lda")
  }
  choices <- pmin(choices, ncol(u))
  df.u <- as.data.frame(sweep(u[, choices], 2, d[choices]^obs.scale, 
                              FUN = "*"))
  v <- sweep(v, 2, d^var.scale, FUN = "*")
  df.v <- as.data.frame(v[, choices])
  names(df.u) <- c("xvar", "yvar")
  names(df.v) <- names(df.u)
  if (pc.biplot) {
    df.u <- df.u * nobs.factor
  }
  r <- sqrt(qchisq(circle.prob, df = 2)) * prod(colMeans(df.u^2))^(1/4)
  v.scale <- rowSums(v^2)
  df.v <- r * df.v/sqrt(max(v.scale))
  if (obs.scale == 0) {
    u.axis.labs <- paste("standardized PC", choices, sep = "")
  }
  else {
    u.axis.labs <- paste("PC", choices, sep = "")
  }
  u.axis.labs <- paste(u.axis.labs, sprintf("(%0.1f%% explained var.)", 
                                            100 * pcobj$sdev[choices]^2/sum(pcobj$sdev^2)))
  if (!is.null(labels)) {
    df.u$labels <- labels
  }
  if (!is.null(groups)) {
    df.u$groups <- groups
  }
  if (!is.null(shapes)) {
    df.u$shapes <- shapes
  }
  if (varname.abbrev) {
    df.v$varname <- abbreviate(rownames(v))
  }
  else {
    df.v$varname <- rownames(v)
  }
  df.v$angle <- with(df.v, (180/pi) * atan(yvar/xvar))
  df.v$hjust = with(df.v, (1 - varname.adjust * sign(xvar))/2)
  g <- ggplot(data = df.u, aes(x = xvar, y = yvar, family="Arial")) + xlab(u.axis.labs[1]) + 
    ylab(u.axis.labs[2]) + coord_equal()
  if (var.axes) {
    if (circle) {
      theta <- c(seq(-pi, pi, length = 50), seq(pi, -pi, 
                                                length = 50))
      circle <- data.frame(xvar = r * cos(theta), yvar = r * 
                             sin(theta))
      g <- g + geom_path(data = circle, color = muted("white"), 
                         size = 1/2, alpha = 1/3)
    }
    g <- g + geom_segment(data = df.v, aes(x = 0, y = 0, 
                                           xend = xvar, yend = yvar), arrow = arrow(length = unit(1/2, 
                                                                                                  "picas")), color = "black")
  }
  if (!is.null(df.u$labels)) {
    if (!is.null(df.u$groups)) {
      g <- g + geom_text(aes(label = labels, color = groups), 
                         size = labels.size, family="Arial", position=position_jitter(width=0.15, height=0.15)) #here
    }
    else {
      g <- g + geom_text(aes(label = labels), size = labels.size, family="Arial", position=position_jitter(width=0.15, height=0.15))
    }
  }
  else {
    if (!is.null(df.u$groups)) {
      if (!is.null(df.u$shapes)) {
        df.u$shapes <- as.factor(df.u$shapes)
        levels(df.u$shapes) <- rep(21:25, (length(df.u$shapes)))
        g <- g +  geom_point(aes(color = "black", shape = as.integer(as.character(df.u$shapes)), fill=groups, size=3), alpha = alpha) +
          scale_shape_identity() #aes(color = groups, shape = as.integer(as.character(df.u$shapes)), fill = groups, size=3)
      }
      else {
        g <- g +  geom_point(aes(color = groups), alpha = alpha)
      }
    }
    else {
      g <- g + geom_point(alpha = alpha)
    }
  }
  if (!is.null(df.u$groups) && ellipse) {
    theta <- c(seq(-pi, pi, length = 50), seq(pi, -pi, length = 50))
    circle <- cbind(cos(theta), sin(theta))
    ell <- ddply(df.u, "groups", function(x) {
      if (nrow(x) <= 2) {
        return(NULL)
      }
      sigma <- var(cbind(x$xvar, x$yvar))
      mu <- c(mean(x$xvar), mean(x$yvar))
      ed <- sqrt(qchisq(ellipse.prob, df = 2))
      data.frame(sweep(circle %*% chol(sigma) * ed, 2, 
                       mu, FUN = "+"), groups = x$groups[1])
    })
    names(ell)[1:2] <- c("xvar", "yvar")
    g <- g + geom_path(data = ell, aes(color = groups, group = groups))
  }

  if (var.axes) {
      if (flip.x==T & flip.y !=T) {
        g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size ,nudge_x=-.1, nudge_y=.1)
      } #let's see? had the else here.
      else if (flip.y==T & flip.x !=T) {
        g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size,nudge_x=.1, nudge_y=-.1)
      }
      else if (flip.y==T & flip.x ==T) {
        g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size,nudge_x=-.1, nudge_y=-.1)
      }
     else
    g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size)
    #    g <- g + geom_text(data = df.v, aes(label = varname, 
            #  x = xvar, y = yvar, angle = angle, hjust = hjust, family="Arial"), 
             # color = "black", size = varname.size)
          }
  if (flip.x==T) {
    g <- g + scale_x_reverse()
  }  
  if (flip.y==T) {
    g <- g + scale_y_reverse()
  }  
  return(g)
}

```

```{r OSF pull, echo=FALSE, include=FALSE}
osf_retrieve_node("https://osf.io/bg6mq")%>%
  osf_ls_files() %>%
  osf_download(conflicts = "overwrite")


v1MS <- read.csv(file="v1MS.csv")
summary(v1MS) 

## Create variables for V1a Comparison
Species <- v1MS$X
fullname <- v1MS$fullname
Familyg <- v1MS$family
mygenus <- v1MS$genus

## Subset data points with relative binding, 
## such that there are more species than regions 
## (in order to not violate PCA assumptions)
v1MSregions <- v1MS[,5:10]

V1new <- c(x = 'Pouched rat', family = 'Nesomyidae', genus = 'Cricetomys', fullname = 'Cricetomys ansorgei', "VPal" = as.numeric(1), "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "DG" = 1)
pouchie_adonisdata <- rbind(v1MS, V1new)
pouchie_adonisdata$VPal <- as.numeric(as.character(pouchie_adonisdata$VPal))
pouchie_adonisdata$LS <- as.numeric(as.character(pouchie_adonisdata$LS))
pouchie_adonisdata$BNST <- as.numeric(as.character(pouchie_adonisdata$BNST))
pouchie_adonisdata$CeA <- as.numeric(as.character(pouchie_adonisdata$CeA))
pouchie_adonisdata$MeA <- as.numeric(as.character(pouchie_adonisdata$MeA))
pouchie_adonisdata$DG <- as.numeric(as.character(pouchie_adonisdata$DG))

pouchie_MSregions <- pouchie_adonisdata[, 5:10]

Familypg <- pouchie_adonisdata$family
mypgenus <- pouchie_adonisdata$genus

##pouchie included adonis.
glimpse(pouchie_adonisdata)
adonis(pouchie_MSregions ~ Familypg, data= pouchie_adonisdata, perm = 1000)
adonis(pouchie_MSregions ~ mypgenus, data= pouchie_adonisdata, perm = 1000)



## Permutational MANOVA with family group (V1aR maximized species)
glimpse(v1MS)
adonis(v1MSregions ~ Familyg, data= v1MS, perm = 1000)

## Permutational MANOVA with genus group (V1aR maximized species)
adonis(v1MSregions ~ mygenus, data= v1MS, perm = 1000)

## fit principle components of this subset
#fitv1MS <- princomp(v1MSregions, cor=T)
#loadings(fitv1MS)
#summary(fitv1MS)

#####Adding new datapoint

fitv1MS_NEW <- prcomp(v1MSregions, scale=TRUE, retx=TRUE)
fitv1MS_NEW$x
summary(fitv1MS_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchiev1 <- data.frame("VPal" = 1, "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "DG" = 1)
pouchie_v1MSpoint <- scale(pouchiev1, fitv1MS_NEW$center, fitv1MS_NEW$scale) %*% fitv1MS_NEW$rotation 





#############



## Create color spectrum
tol11qualitative=c("#332288", "#6699CC", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#661100", "#CC6677", "#882255", "#AA4499")
tol12qualitative=c("#332288", "#6699CC", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#661100", "#CC6677", "#AA4466", "#882255", "#AA4499")
 
#pal(tol7qualitative)


```

```{r V1aR maximized species, echo = FALSE, include=FALSE}
## create PCA figure V1aR maximized species
figv1MS <- ggbiplot(fitv1MS_NEW, obs.scale = 1, var.scale = 1, 
               ellipse = F, labels=fullname, groups=mygenus,
               label.size = 6, varname.size = 4,
               circle = F)

#add pouchie data onto the plot dataframe
figv1MS$data <- rbind(figv1MS$data, 
  data.frame(
    xvar = pouchie_v1MSpoint[, "PC1"],
    yvar = pouchie_v1MSpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)

figv1MS <- figv1MS+ scale_x_continuous(limits=c( -3, 3.5))
figv1MS <- figv1MS + scale_y_continuous(limits=c(-2.5, 3))
figv1MS <- figv1MS + scale_color_manual(values=(tol12qualitative)) +  scale_fill_manual(values=(tol12qualitative)) #had to alter color scheme to accommodate new point
figv1MS <- figv1MS + theme_few()  + theme(legend.direction = 'horizontal', 
                                legend.position = 'top', legend.title=element_blank())

#figv1MS <- figv1MS+ scale_x_reverse(limits=c( 3.5, -3)) #if Flip.x is T, need to specify a reversed x scale.

print(figv1MS)
ggsave("Figure v1ar max species.png", width=8, height=6, dpi=600)
```






![a PCA, V1aR with species maximized](Figure v1ar max species.png)

```{r V1aR maximized regions, echo = FALSE, include=FALSE}
# V1aR maximized regions --------------------------------------------------

#V1ar part 2 - maximizing brain regions

v1MR <- read.csv(file="v1MR.csv")
summary(v1MR) 

## Create variables for V1a Comparison
SpeciesMR <- v1MR$X
fullnameMR <- v1MR$fullname
FamilyMR <- v1MR$family
mygenusMR <- v1MR$genus

## Subset data points with relative binding, such that there are more species than regions (in order to not violate test assumption)
v1MRregions <- v1MR[,5:15]


V1MRnew <- c(x = 'Pouched rat', family = 'Nesomyidae', genus = 'Cricetomys', fullname = 'Cricetomys ansorgei', "OB" = 2, "VPal" = 1, "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "BLA" = 1, "CA1" = 0, "CA3" = 0, "DG" = 1, "SCOL" = 1)
pouchie_2data <- rbind(v1MR, V1MRnew)
pouchie_2data$OB <- as.numeric(as.character(pouchie_2data$OB))
pouchie_2data$VPal <- as.numeric(as.character(pouchie_2data$VPal))
pouchie_2data$LS <- as.numeric(as.character(pouchie_2data$LS))
pouchie_2data$BNST <- as.numeric(as.character(pouchie_2data$BNST))
pouchie_2data$CeA <- as.numeric(as.character(pouchie_2data$CeA))
pouchie_2data$MeA <- as.numeric(as.character(pouchie_2data$MeA))
pouchie_2data$BLA <- as.numeric(as.character(pouchie_2data$BLA))
pouchie_2data$CA1 <- as.numeric(as.character(pouchie_2data$CA1))
pouchie_2data$CA3 <- as.numeric(as.character(pouchie_2data$CA3))
pouchie_2data$DG <- as.numeric(as.character(pouchie_2data$DG))
pouchie_2data$SCOL <- as.numeric(as.character(pouchie_2data$SCOL))

pouchie_MRregions <- pouchie_2data[, 5:15]

Familypg2 <- pouchie_2data$family
mypgenus2 <- pouchie_2data$genus

##pouchie included adonis.
glimpse(pouchie_2data)
adonis(pouchie_MRregions ~ Familypg2, data= pouchie_2data, perm = 1000)
adonis(pouchie_MRregions ~ mypgenus2, data= pouchie_2data, perm = 1000)




#permutational MANOVA V1aR family comparison max regions
adonis(v1MRregions ~ FamilyMR, data= v1MR, perm = 1000)

#permutational MANOVA V1aR family comparison max regions
adonis(v1MRregions ~ mygenusMR, data= v1MR, perm = 1000)


## fit principal components of this subset
#fitv1MR <- princomp(v1MRregions, cor=T)
#loadings(fitv1MR)

#####Adding new datapoint

fitv1MR_NEW <- prcomp(v1MRregions, scale=TRUE, retx=TRUE)
fitv1MR_NEW$x
summary(fitv1MR_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchiev1MR <- data.frame("OB" = 2, "VPal" = 1, "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "BLA" = 1, "CA1" = 0, "CA3" = 0, "DG" = 1, "SCOL" = 1)
pouchie_v1MRpoint <- scale(pouchiev1MR, fitv1MR_NEW$center, fitv1MR_NEW$scale) %*% fitv1MR_NEW$rotation 




# Select graph colors
tol9qualitative=c("#332288", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#CC6677", "#882255", "#AA4499")
tol10qualitative=c("#332288", "#88CCEE", "#44AA99", "#117733", "#999933",
                     "#DDCC77", "#661100", "#CC6677", "#882255", "#AA4499")
```

```{r v1 max region plot, echo=FALSE, include=FALSE}
fig2 <- ggbiplot(fitv1MR_NEW, obs.scale = 1, var.scale = 1, 
               ellipse = F, labels=fullnameMR, groups=mygenusMR,
               label.size = 6, varname.size = 4,
               circle = F, flip.x=T, flip.y = T) ## to see the brain regions

#add pouchie data onto the plot dataframe
fig2$data <- rbind(fig2$data, 
  data.frame(
    xvar = pouchie_v1MRpoint[, "PC1"],
    yvar = pouchie_v1MRpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)

fig2 <- fig2  +  scale_x_reverse(limits=c( 4.5, -4)) # because flipx is T, must reverse scale.
fig2 <- fig2 + scale_y_reverse(limits=c(3, -3))
fig2 <- fig2 + scale_color_manual(values=(tol10qualitative)) + scale_fill_manual(values=(tol10qualitative))
fig2 <- fig2 + theme_few()  + theme(legend.direction = 'horizontal', 
                                legend.position = 'top', legend.title=element_blank())
print(fig2)

## save a copy to folder
ggsave("Figure v1ar max regions.png", width=8, height=6, dpi=600)


```



![a PCA, V1aR with regions maximized](Figure v1ar max regions.png)

```{r OTR maximized species, echo = FALSE, include=FALSE}

# OTR ---------------------------------------------------------------------

# OTR maximized species ---------------------------------------------------


tol15rainbow=c("#114477", "#4477AA", "#77AADD", "#117755", "#44AA88", "#99CCBB", "#777711", "#AAAA44", "#DDDD77", "#771111", "#AA4444", "#DD7777", "#771144", "#AA4477", "#DD77AA")
tol18rainbow=c("#771155", "#AA4488", "#CC99BB", "#114477", "#4477AA", "#77AADD", "#117777", "#44AAAA", "#77CCCC", "#777711", "#AAAA44", "#DDDD77", "#774411", "#AA7744", "#DDAA77", "#771122", "#AA4455", "#DD7788")



otMS <- read.csv(file="otMS.csv")
summary(otMS) 

## save variables for OTR
SpeciesotMS <- otMS$X
fullnameotMS <- otMS$fullname
FamilyotMS <- otMS$family
genusotMS <- otMS$genus

## again subset to have correct data type - no NAs, fewer vars than species
otMSregions <- otMS[,5:11]

#permutational MANOVA with family group as predictor
adonis(otMSregions ~ FamilyotMS, data= otMS, perm = 1000)

#permutational MANOVA with genus group as predictor
adonis(otMSregions ~ genusotMS, data= otMS, perm = 1000)

#Fit a pca
#fitotMS <- princomp(otMSregions, cor=T)
#summary(fitotMS)
#loadings(fitotMS)

#####Adding new datapoint

fitotMS_NEW <- prcomp(otMSregions, scale=TRUE, retx=TRUE)
fitotMS_NEW$x
summary(fitotMS_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchieotMS <- data.frame("LS" = 1, "BNST" = 2, "CeA" = 2, "MeA" = 1, "CA1" = 1, "CA3" = 1, "DG" = 0)
pouchie_otMSpoint <- scale(pouchieotMS, fitotMS_NEW$center, fitotMS_NEW$scale) %*% fitotMS_NEW$rotation 



#set colors
tol14rainbow=c("#882E72", "#B178A6", "#D6C1DE", "#1965B0", "#5289C7", "#7BAFDE", "#4EB265", "#90C987", "#CAE0AB", "#F7EE55", "#F6C141", "#F1932D", "#E8601C", "#DC050C")
tol15rainbow=c("#114477", "#4477AA", "#77AADD", "#117755", "#44AA88", "#99CCBB", "#777711", "#AAAA44", "#DDDD77", "#771111", "#AA4444", "#DD7777", "#771144", "#AA4477", "#DD77AA")

```

```{r, echo = FALSE, include=FALSE}
figotMS <- ggbiplot(fitotMS_NEW, obs.scale = 1, var.scale = 1, 
              ellipse = F, group=genusotMS, labels=fullnameotMS,
              label.size = 6, varname.size = 4,
              circle = F)

#add pouchie data onto the plot dataframe
figotMS$data <- rbind(figotMS$data, 
  data.frame(
    xvar = pouchie_otMSpoint[, "PC1"],
    yvar = pouchie_otMSpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)


figotMS <- figotMS  + scale_y_continuous(limits=c(-3, 3))
figotMS <- figotMS + scale_x_continuous(limits=c(-5, 5))
figotMS <- figotMS + scale_color_manual(values=tol15rainbow) + scale_fill_manual(values=tol15rainbow)
figotMS <- figotMS + theme_few() + theme(legend.direction = 'horizontal', 
                             legend.position = 'top', legend.title=element_blank())
print(figotMS)

##save to computer
ggsave("FIGURE otr max species.png", width=8, height=6, dpi=600)

```

![a PCA, OTR with species maximized](FIGURE otr max species.png)




```{r OTR maximized regions, echo = FALSE, include=FALSE}
# OTR maximized regions ---------------------------------------------------

#OTR part 2 - maximizing brain regions


otMR <- read.csv(file="otMR.csv")
summary(otMR) 

## save variables for OTR
SpeciesotMR <- otMR$X
fullnameotMR <- otMR$fullname
FamilyotMR <- otMR$family
genusotMR <- otMR$genus

## again subset to have correct data type - no NAs, fewer vars than species
otMRregions <- otMR[,5:15]

# permutational MANOVA with family predictor
adonis(otMRregions ~ FamilyotMR, data= otMR, perm = 1000)

# permutational MANOVA with genus predictor
adonis(otMRregions ~ genusotMR, data= otMR, perm = 1000)

```


```{r, echo = FALSE, include=FALSE}
#Fit a pca
#fitotMR <- princomp(otMRregions, cor=T)
#summary(fitotMR)
#loadings(fitotMR)

#####Adding new datapoint
?prcomp
fitotMR_NEW <- prcomp(otMRregions, scale=TRUE, retx=TRUE)
fitotMR_NEW$x
summary(fitotMR_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchieotMR <- data.frame("NAcc" = 1, "LS" = 1, "VPal" = 1,  "BNST" = 2, "VMH" = 3, "CeA" = 2, "MeA" = 1, "BLA" = 2, "CA1" = 1, "CA3" = 1, "DG" = 0)
pouchie_otMRpoint <- scale(pouchieotMR, fitotMR_NEW$center, fitotMR_NEW$scale) %*% fitotMR_NEW$rotation 




#Create an OTR graph

fig4 <- ggbiplot(fitotMR_NEW, obs.scale = 1, var.scale = 1, 
              ellipse = F, group=genusotMR, labels=fullnameotMR,
              label.size = 6, varname.size = 4,
              circle = F)

#add pouchie data onto the plot dataframe
fig4$data <- rbind(fig4$data, 
  data.frame(
    xvar = pouchie_otMRpoint[, "PC1"],
    yvar = pouchie_otMRpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)


fig4  <- fig4   + scale_y_continuous(limits=c(-4, 4))
fig4  <- fig4  + scale_x_continuous(limits=c(-6, 6))
fig4  <- fig4  + scale_color_manual(values=tol12qualitative) + scale_fill_manual(values=tol12qualitative)
fig4  <- fig4  + theme_few() + theme(legend.direction = 'horizontal', 
                             legend.position = 'top', legend.title=element_blank()) 
print(fig4)

##save to computer
ggsave("Figure 2 OTR max regions.png", width=8, height=6, dpi=600)

```

![a PCA, OTR with regions maximized](Figure 2 OTR max regions.png)


>-Where did we see binding for OTR 

>-Where did we see binding for V1aR 

>-Sex differences 

>-Predict with PCA 

\newpage


# Discussion 


>-We found OTR in … V1aR in…. 

>-Sex differences in densities/presence and absence 

>-We found that overall patterns were similar to….. 

>-Caveats 

>>-Unknown age 

>>-Unknown reproductive status 

>>-Different experiences possible 

>-What this means, similarities to other species 

>-Relevance for behavior or life history 

What still needs to be known? 


References {#references .unnumbered}
==========
