---
title: Oxytocin and Vasopressin Receptors in the Pouched Rat
author:
  - name: Samanta Arenas
    email: sa658@cornell.edu
    affiliation: Cornell University
  - name: Angela R. Freeman
    email: arf86@cornell.edu
    affiliation: Cornell University
  - name: Bhupinder Singh
    email: bs256@cornell.edu
    affiliation: Vetschool
  - name: Alexander G. Ophir
    email: ophir@cornell.edu
    affiliation: Cornell University
    footnote: 1
address:
  - code: Cornell University
    address: Cornell University, Department of Psychology, Ithaca, NY, 14853
  - code: Vetschool
    address: Cornell University, Department of Veterinary Medicine, Ithaca, NY, 14853
footnote:
  - code: 1
    text: "Corresponding Author"
abstract: |
  This is the abstract.
  It consists of two paragraphs.
journal: "Journal of Neuroscience"
date: "`r Sys.Date()`"
bibliography: library.bib
linenumbers: true
#numbersections: true
csl: elsevier-harvard.csl
geometry: margin=2cm
header-includes:
  - \usepackage{setspace}\doublespacing
output: rticles::elsevier_article
editor_options: 
  chunk_output_type: console
---
```{r, echo = FALSE}
# For this document to work well, I recommend that you have the packages citr, rticles installed and loaded.

# For more information on Rmarkdown, check out https://rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf

# The paths to the datafiles used for the manuscript need to be changed to where you have these files on your computer.

#The bibliography file should be in your project directory (where this Rmarkdown file is) for references to render properly.

#To 'track changes' see the syntax used here: http://criticmarkup.com/users-guide.php
# However, comments {>> This appears as a comment in rendering to word docs<<}
# are always welcome.

OTRdata <-read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad OTR FINAL.csv")
V1data <- read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad V1ar FINAL.csv")
OTRPCAdata <-read.csv("C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad OTR PCA.csv")
V1PCAdata <-read.csv(file="C:/Users/HP/Documents/Work/Pouched_rat/autorad pouchie/Pouchie Autorad V1ar PCA.csv")

```



# Introduction 

The neuropeptides, oxytocin (OT) and vasopressin (VP), have receptor distributions in the brain that can modulate a variety of social behaviors such as parental care, affiliation, and aggression, among other behaviors [@caldwellOxytocinVasopressinMotivational2015]. The densities of their associated receptors, oxytocin (OTR) and vasopressin (V1aR and V1bR) receptors, are often species- and sex-dependent.
 

>- What do we know about the distribution and relative densities of receptors (i.e. what can it tell us, what’s been done on behavior?) 

>-How might life history differences play into patterning of central distribution of these receptors? 

>-What tends to be conserved? 

>-How does comparative analysis help? [@kellyComparedWhatWhat2015] 

>-Why did we do this study? What were we examining? 

>-We wanted to describe the presence and relative density of OTR and V1aR in pouched rat brains in males and females, to see if there were differences in presence and density between sexes 

>-We wanted to explore how the patterning of these receptors might differ from other rodents and see if it further supports the ideas found in the recent metaanalysis [@freemanComparisonDistributionOxytocin2020](see where pouched rats fall in this framework) 

 
 

# Methods 



>-Brain removal 

>-Statement of animal welfare/approvals 

 

Ten male and ten female brains were stored at -80ºC temperature. Brains were split into two hemispheres and coronally sectioned at 20µm thick. Due to the large size of the pouched rat brains, only the left hemisphere was sectioned if it was in good formation, and each section kept was followed by two discarded sections. 

 

>-Thus we mounted every… third section,  

 

>-The cerebellum was removed and the olfactory bulbs placed in centrifuge tubes. 
4
>- Brain sections were placed onto six sets of Superfrost Plus Plexiglas Slides (Fisher Scientific, Pittsburg, PA USA). Slides were stored in the -80ºC freezer until they were needed for autoradiography labeling to visualize receptor density. 125I radioligands were used to label oxytocin receptor (ornithine vasopressin analog, 125I-OVTA); NEX 254, PerkinElmer; Waltham, MA) or vasopressin 1a receptor (vasopressin (Linear), V-1A antagonist (Phenylacetyl1, 0-Me-D-Tyr2 [125I-Arg6]-); NEX 310, PerkinElmer), as described by (Ophir et al. 2013).

 

>- Change this. 

 

The radiolabeled slides were left stored in film cassettes and later exposed to phosphoreimaging screens (Fujifilm, Tokyo, Japan) for 23 hours. Under dark light, the screens were removed from the cassettes and placed in a Typhoon FLA 7000 laser scanner (GE Healthcare, Marlborough, MA, USA). The screens were then analyzed using ImageJ Version ? . Three sequential slices were measured for density by encircling the regions of interest using the ImageJ program. The program automatically calculated mean values and area for regions of interest and background. 125I-labeled radiographic microscales were used to produce decay formulas in order to transform average intensity measures into standardized disintegrations per minute (dpm) values.  

 

Transformed values from the cortex taken as background from the same sequential (every 3rd) slices at each region of interest were subtracted from the standardized values of these regions of interest to calculate the final mea4n receptor density value (units are dpm/mg tissue equivalence (TE); for 1 mg in rat brain).  

 

>-cresyl violet 

>-use of atlas 


OTR was measured in the olfactory bulb (OB), anterior olfactory nucleus (AON), prefrontal cortex (PFC), piriform cortex (Pir), nucleus accumbens (NAcc), lateral septum (LS), endopiriform (Den), claustrum (VCL), lateral bed nucleus of the stria terminalis (BSTl), medial bed nucleus of the stria terminalis (BSTm), ventral bed nucleus of the stria terminalis (BSTv), ventral pallidum (VPall), medial preoptic area (MPOA), anterior hypothalamus (AH), paraventricular thalamus (PVT), suprachiasmatic nucleus (SCN), paraventricular nucleus (PVN), magnocellular hypothalamic nucleus (MCPO), medial habenula (MHb), central amygdala (CeA), medial amygdala (MeA), basolateral amygdala (BLA), ventromedial hypothalamus (VMH), zona incerta (ZIR), lateral hypothalamus (PrFLH), hippocampal CA1, hippocampal CA2, hippocampal CA3, dentate gyrus (DG), premammilary ventral nucleus (PMV), ventral tegmental area (VTA), periaqueductal gray (PAG), medial geniculate (MG), superior colliculus (SuG), and the ventral CA3. V1aR was measured in the same regions except for the MCPO and the MHb. 

 

>-statistical methods 

 

# Results 

```{r load packages set functions, echo=FALSE, results="hide", message=FALSE}
# load all necessary libraries ----
load_pkg <- rlang::quos(tidyverse, ade4, ade4TkGUI, exactRankTests, ggplot2, stargazer, ggthemes, lme4, lmerTest, emmeans, extrafont, car, corrplot, tidyverse, dplyr, ggpubr, osfr, broom, vegan)

invisible(lapply(lapply(load_pkg, rlang::quo_name),
  library,
  character.only = TRUE
))
#font_import() #if you haven't loaded and run extrafont package before

#
serr <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))

theme_alex <- function(base_size=24, base_family ="Arial") {
  theme_few() %+replace%
    theme(axis.ticks = element_blank(), legend.title=element_text(size=24, face="bold"), 
          axis.title=element_text(size=24,face="bold"),
          axis.line = element_line(colour = "black"),
          panel.border = element_blank(),
          legend.position = "right")
  
}

summary(OTRdata)
summary(V1data)

summary(lm(OB..final. ~ Sex, data=OTRdata))

# Run t-tests ----
t.test(OB..final. ~Sex, data=OTRdata)
t.test(AON..final. ~Sex, data=OTRdata)
t.test(mPFC..final. ~Sex, data=OTRdata)
t.test(mPFC..final..1 ~Sex, data=OTRdata)
t.test(Nacc..final. ~Sex, data=OTRdata)
t.test(Nacc..final..1 ~Sex, data=OTRdata)
t.test(Caudate.P..Final. ~Sex, data=OTRdata)
t.test(PirCtx..final. ~Sex, data=OTRdata)
t.test(LS.I..final. ~Sex, data=OTRdata)
t.test(LS.D..final. ~Sex, data=OTRdata)
t.test(LSV..final. ~Sex, data=OTRdata)
t.test(Endopir..final. ~Sex, data=OTRdata)
t.test(Claustrum..final. ~Sex, data=OTRdata)
t.test(BSTm..final. ~Sex, data=OTRdata)
t.test(BSTi..final. ~Sex, data=OTRdata)
t.test(BSTv..final. ~Sex, data=OTRdata)
t.test(Vpall..final. ~Sex, data=OTRdata)
t.test(MPOA..final. ~Sex, data=OTRdata)
t.test(AH..final. ~Sex, data=OTRdata)
t.test(PVT..final. ~Sex, data=OTRdata)
t.test(SCN..final. ~Sex, data=OTRdata)
t.test(PVN..final. ~Sex, data=OTRdata)
t.test(MHypNuc..final. ~Sex, data=OTRdata)
t.test(Med.Habenula..final. ~Sex, data=OTRdata)
t.test(CeA..final. ~Sex, data=OTRdata)
t.test(MeA..final. ~Sex, data=OTRdata)
t.test(BLA..final. ~Sex, data=OTRdata)
t.test(VMH..final. ~Sex, data=OTRdata)
t.test(Zona.Incert..final. ~Sex, data=OTRdata)
t.test(Lat.Hyp..final. ~Sex, data=OTRdata)
t.test(CA1..final. ~Sex, data=OTRdata)
t.test(CA2..final. ~Sex, data=OTRdata)
t.test(CA3..final. ~Sex, data=OTRdata)
t.test(DG..final. ~Sex, data=OTRdata)
t.test(Premamm..final. ~Sex, data=OTRdata)
t.test(VTA..final. ~Sex, data=OTRdata)
t.test(PAG..final. ~Sex, data=OTRdata)
t.test(Mgen..final. ~Sex, data=OTRdata)
scol.OT <- t.test(Scol..final. ~Sex, data=OTRdata)
t.test(Ventral.CA3..final. ~Sex, data=OTRdata)

t.test(OB..final. ~Sex, data=V1data)
t.test(AON..final. ~Sex, data=V1data)
t.test(mPFC..final. ~Sex, data=V1data)
t.test(mPFC..final..1 ~Sex, data=V1data)
t.test(Nacc..final. ~Sex, data=V1data)
t.test(Nacc..final..1 ~Sex, data=V1data)
t.test(Caudate.P..Final. ~Sex, data=V1data)
t.test(PirCtx..final. ~Sex, data=V1data)
t.test(LS.I..final. ~Sex, data=V1data)
t.test(LS.D..final. ~Sex, data=V1data)
t.test(LSV..final. ~Sex, data=V1data)
t.test(Endopir..final. ~Sex, data=V1data)
t.test(Claustrum..final. ~Sex, data=V1data)
t.test(BSTm..final. ~Sex, data=V1data)
t.test(BSTi..final. ~Sex, data=V1data)
t.test(BSTv..final. ~Sex, data=V1data)
t.test(Vpall..final. ~Sex, data=V1data)
t.test(MPOA..final. ~Sex, data=V1data)
t.test(AH..final. ~Sex, data=V1data)
t.test(PVT..final. ~Sex, data=V1data)
t.test(SCN..final. ~Sex, data=V1data)
t.test(PVN..final. ~Sex, data=V1data)
#t.test(MHypNuc..final. ~Sex, data=V1data)
#t.test(Med.Habenula..final. ~Sex, data=V1data)
t.test(CeA..final. ~Sex, data=V1data)
t.test(MeA..final. ~Sex, data=V1data)
t.test(BLA..final. ~Sex, data=V1data)
t.test(VMH..final. ~Sex, data=V1data)
t.test(Zona.Incert..final. ~Sex, data=V1data)
t.test(Lat.Hyp..final. ~Sex, data=V1data)
t.test(CA1..final. ~Sex, data=V1data)
t.test(CA2..final. ~Sex, data=V1data)
t.test(CA3..final. ~Sex, data=V1data)
t.test(DG..final. ~Sex, data=V1data)
t.test(Premamm..final. ~Sex, data=V1data)
t.test(VTA..final. ~Sex, data=V1data)
t.test(PAG..final. ~Sex, data=V1data)
t.test(Mgen..final. ~Sex, data=V1data)
t.test(Scol..final. ~Sex, data=V1data)
t.test(BSTv..final. ~Sex, data=V1data)
t.test(Ventral.CA3..final. ~Sex, data=V1data)
```

After comparing male and female densities in the measured regions, most regions showed no differences between sexes. The superior colliculus had higher densities of OTR in females compared to males (Female mean: `r round(scol.OT$estimate[1], digits= 2)`, Male mean `r round(scol.OT$estimate[2], digits = 2)`, t~(`r round(scol.OT$parameter, digits = 2)`)~ = `r round(scol.OT$statistic, digits = 2)`, p = `r round(scol.OT$p.value, digits = 2)`), however, this was no longer significant after corrections for multiple comparisons.




```{r pouchie ot data, echo=FALSE, results="hide"}
# graphing ----------------------------------------------------------------

# M <- cor(OTRPCAdata[,3:42], use="pairwise.complete.obs")
# warnings()
# corrplot(M, method="circle")
# OTR.pca <- prcomp(M)
# summary(OTR.pca)
# OTRPCAdata$ID <- as.factor(OTRPCAdata$ID)
# ggbiplot(OTR.pca, groups=OTRPCAdata$Sex, ellipse=T)

OTRPCAdatalong <- gather(OTRPCAdata, condition, measurement,  Olfactory.Bulb:Ventral.CA3, factor_key=T)
#head(OTRPCAdatalong)


# ggplot(OTRPCAdatalong, aes(x = Sex, y = measurement, group=condition, color=Sex, group=Sex)) +
#   geom_violin() +
#   facet_wrap(~ condition, ncol=4)
# 
```

\newpage
```{r OTR table, echo=FALSE, message=FALSE}
sum_OTdata <- OTRPCAdatalong %>% drop_na() %>%
    group_by(condition, Sex) %>%
    dplyr::summarize(density_mean = round(mean(measurement), digits = 2),
              density_serr = round(serr(measurement), digits = 2),
              n_datapoints =n()) %>%
  ungroup()

sum_OTdata$condition <- gsub("[.]", " ", sum_OTdata$condition) 
kable_OTcol2 <- paste(sum_OTdata$density_mean, "±", sum_OTdata$density_serr)

sum_OTdata2 <- sum_OTdata %>% select(-one_of("density_serr"), -one_of("density_mean"))  %>% add_column(kable_OTcol2, .before= "n_datapoints") %>% filter(condition !="Dentate Gyrus" & condition !="Medial Geniculate" & condition !="Ventral CA3")
                        
large_colnames <- c("Region", "Sex", "Density mean ± SE (dpm/mg)", "N")
knitr::kable(sum_OTdata2, col.names = large_colnames, align='llrr', caption="OTR densities by region and sex")
```
\newpage

```{r OTR relative table, echo=FALSE}
OTRcategory <- data.frame("Region" = c("Olfactory Bulb", "Nucleus Accumbens", "mPFC", "Ventral Pallidum", "Lateral Septum", "BST", "CeA", "MeA", "Hippocampus", "VMH", "VTA"), "Relative Binding" = c("+", "+", "+", "-", "+", "++", "++", "+", "+", "+++", "++"))

knitr::kable(OTRcategory, align='lc', caption="OTR relative densities in select regions")

```



```{r pouchie ot boxplot, echo=FALSE, include=FALSE, fig.width= 4, fig.height=7}
ggviolin(OTRPCAdatalong, x = "Sex", y = "measurement", 
         color="Sex", add="jitter") +
  facet_wrap(~ condition, ncol=3, scales="free")


ggboxplot(OTRPCAdatalong, x = "Sex", y = "measurement", 
          color="Sex", add="jitter") +
  facet_wrap(~ condition, ncol=3, scales="free")



# M2 <- cor(V1PCAdata[,10:21])
# corrplot(M2, method="circle")
# V1R.pca <- prcomp(M2)
# summary(V1R.pca)
# ggbiplot(V1R.pca, ellipse=T,  groups=V1PCAdata$Sex)

V1PCAdatalong <- gather(V1PCAdata, condition, measurement, Olfactory.Bulb:Ventral.CA3, factor_key=T)
#head(V1PCAdatalong)

ggviolin(V1PCAdatalong, x = "Sex", y = "measurement", 
         color="Sex", add="jitter") +
  facet_wrap(~ condition, ncol=5, scales="free")

```

\newpage
```{r V1aR table, echo=FALSE, message=FALSE}
sum_data <- V1PCAdatalong %>% drop_na() %>%
    group_by(condition, Sex) %>%
    dplyr::summarize(density_mean = round(mean(measurement), digits = 2),
              density_serr = round(serr(measurement), digits = 2),
              n_datapoints =n()) %>%
  ungroup()

sum_data$condition <- gsub("[.]", " ", sum_data$condition) 
kable_col2 <- paste(sum_data$density_mean, "±", sum_data$density_serr)

sum_data2 <- sum_data %>% select(-one_of("density_serr"), -one_of("density_mean"))  %>% add_column(kable_col2, .before= "n_datapoints") %>% filter(condition !="CA1" & condition !="CA3")
                        
large_colnames <- c("Region", "Sex", "Density mean ± SE (dpm/mg)", "N")
knitr::kable(sum_data2, col.names = large_colnames, align='llrr', caption="V1aR densities by region and sex")
```
\newpage


```{r v1aR relative table, echo=FALSE}
V1rcategory <- data.frame("Region" = c("Olfactory Bulb", "Nucleus Accumbens", "mPFC", "Ventral Pallidum", "Lateral Septum", "BST", "CeA", "MeA", "PVN", "Hippocampus", "Dentate Gyrus", "Premammillary Nucleus", "VMH", "VTA"), "Relative Binding" = c("++", "++", "+", "+", "+++", "++", "++", "+", "+", "-", "+", "++", "+", "+"))

knitr::kable(V1rcategory, align='lc', caption="V1aR relative densities in select regions")

```


```{r pouchie v1 boxplot, echo=FALSE, include=FALSE, fig.width= 4, fig.height=7}
ggboxplot(V1PCAdatalong, x = "Sex", y = "measurement", 
          color="Sex", add="jitter") +
  facet_wrap(~ condition, ncol=5, scales="free")

```



```{r ggbiplot function, echo=FALSE, results="hide"}

# GGbiplot function -------------------------------------------------------
#This function edited to make vector labels parallel and black.
#also new is option to flip x axis, which will nudge the vector labels too

ggbiplot <- function (pcobj, choices = 1:2, scale = 1, pc.biplot = TRUE, 
                      obs.scale = 1 - scale, var.scale = scale, groups = NULL, 
                      ellipse = FALSE, ellipse.prob = 0.68, labels = NULL, shapes = NULL, labels.size = 3, 
                      alpha = 1, var.axes = TRUE, circle = FALSE, circle.prob = 0.69, 
                      varname.size = 3, varname.adjust = 1.5, varname.abbrev = FALSE, flip.x = FALSE, flip.y =                        FALSE,
                      ...) 
{
  library(ggplot2)
  library(plyr)
  library(scales)
  library(grid)
  library(extrafont)
  stopifnot(length(choices) == 2)
  if (inherits(pcobj, "prcomp")) {
    nobs.factor <- sqrt(nrow(pcobj$x) - 1)
    d <- pcobj$sdev
    u <- sweep(pcobj$x, 2, 1/(d * nobs.factor), FUN = "*")
    v <- pcobj$rotation
  }
  else if (inherits(pcobj, "princomp")) {
    nobs.factor <- sqrt(pcobj$n.obs)
    d <- pcobj$sdev
    u <- sweep(pcobj$scores, 2, 1/(d * nobs.factor), FUN = "*")
    v <- pcobj$loadings
  }
  else if (inherits(pcobj, "PCA")) {
    nobs.factor <- sqrt(nrow(pcobj$call$X))
    d <- unlist(sqrt(pcobj$eig)[1])
    u <- sweep(pcobj$ind$coord, 2, 1/(d * nobs.factor), FUN = "*")
    v <- sweep(pcobj$var$coord, 2, sqrt(pcobj$eig[1:ncol(pcobj$var$coord), 
                                                  1]), FUN = "/")
  }
  else if (inherits(pcobj, "lda")) {
    nobs.factor <- sqrt(pcobj$N)
    d <- pcobj$svd
    u <- predict(pcobj)$x/nobs.factor
    v <- pcobj$scaling
    d.total <- sum(d^2)
  }
  else {
    stop("Expected a object of class prcomp, princomp, PCA, or lda")
  }
  choices <- pmin(choices, ncol(u))
  df.u <- as.data.frame(sweep(u[, choices], 2, d[choices]^obs.scale, 
                              FUN = "*"))
  v <- sweep(v, 2, d^var.scale, FUN = "*")
  df.v <- as.data.frame(v[, choices])
  names(df.u) <- c("xvar", "yvar")
  names(df.v) <- names(df.u)
  if (pc.biplot) {
    df.u <- df.u * nobs.factor
  }
  r <- sqrt(qchisq(circle.prob, df = 2)) * prod(colMeans(df.u^2))^(1/4)
  v.scale <- rowSums(v^2)
  df.v <- r * df.v/sqrt(max(v.scale))
  if (obs.scale == 0) {
    u.axis.labs <- paste("standardized PC", choices, sep = "")
  }
  else {
    u.axis.labs <- paste("PC", choices, sep = "")
  }
  u.axis.labs <- paste(u.axis.labs, sprintf("(%0.1f%% explained var.)", 
                                            100 * pcobj$sdev[choices]^2/sum(pcobj$sdev^2)))
  if (!is.null(labels)) {
    df.u$labels <- labels
  }
  if (!is.null(groups)) {
    df.u$groups <- groups
  }
  if (!is.null(shapes)) {
    df.u$shapes <- shapes
  }
  if (varname.abbrev) {
    df.v$varname <- abbreviate(rownames(v))
  }
  else {
    df.v$varname <- rownames(v)
  }
  df.v$angle <- with(df.v, (180/pi) * atan(yvar/xvar))
  df.v$hjust = with(df.v, (1 - varname.adjust * sign(xvar))/2)
  g <- ggplot(data = df.u, aes(x = xvar, y = yvar, family="Arial")) + xlab(u.axis.labs[1]) + 
    ylab(u.axis.labs[2]) + coord_equal()
  if (var.axes) {
    if (circle) {
      theta <- c(seq(-pi, pi, length = 50), seq(pi, -pi, 
                                                length = 50))
      circle <- data.frame(xvar = r * cos(theta), yvar = r * 
                             sin(theta))
      g <- g + geom_path(data = circle, color = muted("white"), 
                         size = 1/2, alpha = 1/3)
    }
    g <- g + geom_segment(data = df.v, aes(x = 0, y = 0, 
                                           xend = xvar, yend = yvar), arrow = arrow(length = unit(1/2, 
                                                                                                  "picas")), color = "black")
  }
  if (!is.null(df.u$labels)) {
    if (!is.null(df.u$groups)) {
      g <- g + geom_text(aes(label = labels, color = groups), 
                         size = labels.size, family="Arial", position=position_jitter(width=0.15, height=0.15)) #here
    }
    else {
      g <- g + geom_text(aes(label = labels), size = labels.size, family="Arial", position=position_jitter(width=0.15, height=0.15))
    }
  }
  else {
    if (!is.null(df.u$groups)) {
      if (!is.null(df.u$shapes)) {
        df.u$shapes <- as.factor(df.u$shapes)
        levels(df.u$shapes) <- rep(21:25, (length(df.u$shapes)))
        g <- g +  geom_point(aes(color = "black", shape = as.integer(as.character(df.u$shapes)), fill=groups, size=3), alpha = alpha) +
          scale_shape_identity() #aes(color = groups, shape = as.integer(as.character(df.u$shapes)), fill = groups, size=3)
      }
      else {
        g <- g +  geom_point(aes(color = groups), alpha = alpha)
      }
    }
    else {
      g <- g + geom_point(alpha = alpha)
    }
  }
  if (!is.null(df.u$groups) && ellipse) {
    theta <- c(seq(-pi, pi, length = 50), seq(pi, -pi, length = 50))
    circle <- cbind(cos(theta), sin(theta))
    ell <- ddply(df.u, "groups", function(x) {
      if (nrow(x) <= 2) {
        return(NULL)
      }
      sigma <- var(cbind(x$xvar, x$yvar))
      mu <- c(mean(x$xvar), mean(x$yvar))
      ed <- sqrt(qchisq(ellipse.prob, df = 2))
      data.frame(sweep(circle %*% chol(sigma) * ed, 2, 
                       mu, FUN = "+"), groups = x$groups[1])
    })
    names(ell)[1:2] <- c("xvar", "yvar")
    g <- g + geom_path(data = ell, aes(color = groups, group = groups))
  }

  if (var.axes) {
      if (flip.x==T | flip.y ==T) {
        g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size, nudge_x = .05, nudge_y=.13)
      } #let's see? had the else here.
     else
    g <- g + geom_text(data = df.v, aes(label = varname, 
                                        x = xvar, y = yvar, hjust = hjust, family="Arial"), 
                       color = "black", size = varname.size)
    #    g <- g + geom_text(data = df.v, aes(label = varname, 
            #  x = xvar, y = yvar, angle = angle, hjust = hjust, family="Arial"), 
             # color = "black", size = varname.size)
  }
  if (flip.x==T) {
    g <- g + scale_x_reverse()
  }  
  if (flip.y==T) {
    g <- g + scale_y_reverse()
  }  
  return(g)
}

```

```{r OSF pull, echo=FALSE, include=FALSE}
osf_retrieve_node("https://osf.io/bg6mq")%>%
  osf_ls_files() %>%
  osf_download(conflicts = "overwrite")


v1MS <- read.csv(file="v1MS.csv")
summary(v1MS) 

## Create variables for V1a Comparison
Species <- v1MS$X
fullname <- v1MS$fullname
Familyg <- v1MS$family
mygenus <- v1MS$genus

## Subset data points with relative binding, 
## such that there are more species than regions 
## (in order to not violate PCA assumptions)
v1MSregions <- v1MS[,5:10]

## Permutational MANOVA with family group (V1aR maximized species)
adonis(v1MSregions ~ Familyg, data= v1MS, perm = 1000)

## Permutational MANOVA with genus group (V1aR maximized species)
adonis(v1MSregions ~ mygenus, data= v1MS, perm = 1000)

## fit principle components of this subset
#fitv1MS <- princomp(v1MSregions, cor=T)
#loadings(fitv1MS)
#summary(fitv1MS)

#####Adding new datapoint

fitv1MS_NEW <- prcomp(v1MSregions, scale=TRUE, retx=TRUE)
fitv1MS_NEW$x
summary(fitv1MS_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchiev1 <- data.frame("VPal" = 1, "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "DG" = 1)
pouchie_v1MSpoint <- scale(pouchiev1, fitv1MS_NEW$center, fitv1MS_NEW$scale) %*% fitv1MS_NEW$rotation 



#############



## Create color spectrum
tol11qualitative=c("#332288", "#6699CC", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#661100", "#CC6677", "#882255", "#AA4499")
tol12qualitative=c("#332288", "#6699CC", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#661100", "#CC6677", "#AA4466", "#882255", "#AA4499")
 
#pal(tol7qualitative)


```

```{r V1aR maximized species, echo = FALSE, include=FALSE}
## create PCA figure V1aR maximized species
figv1MS <- ggbiplot(fitv1MS_NEW, obs.scale = 1, var.scale = 1, 
               ellipse = F, labels=fullname, groups=mygenus,
               label.size = 6, varname.size = 4,
               circle = F, flip.x = T)

#add pouchie data onto the plot dataframe
figv1MS$data <- rbind(figv1MS$data, 
  data.frame(
    xvar = pouchie_v1MSpoint[, "PC1"],
    yvar = pouchie_v1MSpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)

figv1MS <- figv1MS + scale_y_continuous(limits=c(-2.5, 3))
figv1MS <- figv1MS + scale_color_manual(values=(tol12qualitative)) +  scale_fill_manual(values=(tol12qualitative)) #had to alter color scheme to accommodate new point
figv1MS <- figv1MS + theme_few()  + theme(legend.direction = 'horizontal', 
                                legend.position = 'top', legend.title=element_blank())

figv1MS <- figv1MS+ scale_x_reverse(limits=c( 3.5, -3)) #if Flip.x is T, need to specify a reversed x scale.

print(figv1MS)
ggsave("Figure v1ar max species.png", width=8, height=6, dpi=600)
```






![a PCA, V1aR with species maximized](Figure v1ar max species.png)

```{r V1aR maximized regions, echo = FALSE, include=FALSE}
# V1aR maximized regions --------------------------------------------------

#V1ar part 2 - maximizing brain regions

v1MR <- read.csv(file="v1MR.csv")
summary(v1MR) 

## Create variables for V1a Comparison
SpeciesMR <- v1MR$X
fullnameMR <- v1MR$fullname
FamilyMR <- v1MR$family
mygenusMR <- v1MR$genus

## Subset data points with relative binding, such that there are more species than regions (in order to not violate test assumption)
v1MRregions <- v1MR[,5:15]


#permutational MANOVA V1aR family comparison max regions
adonis(v1MRregions ~ FamilyMR, data= v1MR, perm = 1000)

#permutational MANOVA V1aR family comparison max regions
adonis(v1MRregions ~ mygenusMR, data= v1MR, perm = 1000)


## fit principal components of this subset
#fitv1MR <- princomp(v1MRregions, cor=T)
#loadings(fitv1MR)

#####Adding new datapoint

fitv1MR_NEW <- prcomp(v1MRregions, scale=TRUE, retx=TRUE)
fitv1MR_NEW$x
summary(fitv1MR_NEW)
#this function is identical to princomp


# project new data onto the PCA space
pouchiev1MR <- data.frame("OB" = 2, "VPal" = 1, "LS" = 3, "BNST" = 2, "CeA" = 2, "MeA" = 1, "BLA" = 1, "CA1" = 0, "CA3" = 0, "DG" = 1, "SCOL" = 1)
pouchie_v1MRpoint <- scale(pouchiev1MR, fitv1MR_NEW$center, fitv1MR_NEW$scale) %*% fitv1MR_NEW$rotation 




# Select graph colors
tol9qualitative=c("#332288", "#88CCEE", "#44AA99", "#117733", "#999933", "#DDCC77", "#CC6677", "#882255", "#AA4499")
tol10qualitative=c("#332288", "#88CCEE", "#44AA99", "#117733", "#999933",
                     "#DDCC77", "#661100", "#CC6677", "#882255", "#AA4499")
```

```{r echo=FALSE, fig.height=6, fig.width=8, include=FALSE, dpi=600}
fig2 <- ggbiplot(fitv1MR_NEW, obs.scale = 1, var.scale = 1, 
               ellipse = F, labels=fullnameMR, groups=mygenusMR,
               label.size = 6, varname.size = 4,
               circle = F, flip.x=T, flip.y = T) ## to see the brain regions

#add pouchie data onto the plot dataframe
fig2$data <- rbind(fig2$data, 
  data.frame(
    xvar = pouchie_v1MRpoint[, "PC1"],
    yvar = pouchie_v1MRpoint[, "PC2"],
    labels = "Cricetomys ansorgei",
    groups = "Cricetomys"
  )
)

fig2 <- fig2  +  scale_x_reverse(limits=c( 4.5, -4)) # because flipx is T, must reverse scale.
fig2 <- fig2 + scale_y_reverse(limits=c(3, -3))
fig2 <- fig2 + scale_color_manual(values=(tol10qualitative)) + scale_fill_manual(values=(tol10qualitative))
fig2 <- fig2 + theme_few()  + theme(legend.direction = 'horizontal', 
                                legend.position = 'top', legend.title=element_blank())
print(fig2)

## save a copy to folder
ggsave("Figure v1ar max regions.png", width=8, height=6, dpi=600)


```



![a PCA, V1aR with regions maximized](Figure v1ar max regions.png)

```{r OTR maximized species, echo = FALSE, include=FALSE}

# OTR ---------------------------------------------------------------------

# OTR maximized species ---------------------------------------------------


tol15rainbow=c("#114477", "#4477AA", "#77AADD", "#117755", "#44AA88", "#99CCBB", "#777711", "#AAAA44", "#DDDD77", "#771111", "#AA4444", "#DD7777", "#771144", "#AA4477", "#DD77AA")
tol18rainbow=c("#771155", "#AA4488", "#CC99BB", "#114477", "#4477AA", "#77AADD", "#117777", "#44AAAA", "#77CCCC", "#777711", "#AAAA44", "#DDDD77", "#774411", "#AA7744", "#DDAA77", "#771122", "#AA4455", "#DD7788")



otMS <- read.csv(file="otMS.csv")
summary(otMS) 

## save variables for OTR
SpeciesotMS <- otMS$X
fullnameotMS <- otMS$fullname
FamilyotMS <- otMS$family
genusotMS <- otMS$genus

## again subset to have correct data type - no NAs, fewer vars than species
otMSregions <- otMS[,5:11]

#permutational MANOVA with family group as predictor
adonis(otMSregions ~ FamilyotMS, data= otMS, perm = 1000)

#permutational MANOVA with genus group as predictor
adonis(otMSregions ~ genusotMS, data= otMS, perm = 1000)

#Fit a pca
fitotMS <- princomp(otMSregions, cor=T)
summary(fitotMS)
loadings(fitotMS)

#set colors
tol14rainbow=c("#882E72", "#B178A6", "#D6C1DE", "#1965B0", "#5289C7", "#7BAFDE", "#4EB265", "#90C987", "#CAE0AB", "#F7EE55", "#F6C141", "#F1932D", "#E8601C", "#DC050C")


figotMS <- ggbiplot(fitotMS, obs.scale = 1, var.scale = 1, 
              ellipse = F, group=genusotMS, labels=fullnameotMS,
              label.size = 5, varname.size = 2,
              circle = F)
figotMS <- figotMS  + scale_y_continuous(limits=c(-3, 3))
figotMS <- figotMS + scale_x_continuous(limits=c(-5, 5))
figotMS <- figotMS + scale_color_manual(values=tol14rainbow) + scale_fill_manual(values=tol14rainbow)
figotMS <- figotMS + theme_few() + theme(legend.direction = 'horizontal', 
                             legend.position = 'top', legend.title=element_blank())
print(figotMS)

##save to computer
#ggsave("FIGURE otr max species.png", width=8, height=6, dpi=600)

```

```{r OTR maximized regions, echo = FALSE, include=FALSE}
# OTR maximized regions ---------------------------------------------------

#OTR part 2 - maximizing brain regions


otMR <- read.csv(file="otMR.csv")
summary(otMR) 

## save variables for OTR
SpeciesotMR <- otMR$X
fullnameotMR <- otMR$fullname
FamilyotMR <- otMR$family
genusotMR <- otMR$genus

## again subset to have correct data type - no NAs, fewer vars than species
otMRregions <- otMR[,5:15]

# permutational MANOVA with family predictor
adonis(otMRregions ~ FamilyotMR, data= otMR, perm = 1000)

# permutational MANOVA with genus predictor
adonis(otMRregions ~ genusotMR, data= otMR, perm = 1000)


#Fit a pca
fitotMR <- princomp(otMRregions, cor=T)
summary(fitotMR)
loadings(fitotMR)

#Create an OTR graph

fig4 <- ggbiplot(fitotMR, obs.scale = 1, var.scale = 1, 
              ellipse = F, group=genusotMR, labels=fullnameotMR,
              label.size = 5, varname.size = 2,
              circle = F)
fig4  <- fig4   + scale_y_continuous(limits=c(-4, 4))
fig4  <- fig4  + scale_x_continuous(limits=c(-6, 6))
fig4  <- fig4  + scale_color_manual(values=tol11qualitative) + scale_fill_manual(values=tol11qualitative)
fig4  <- fig4  + theme_few() + theme(legend.direction = 'horizontal', 
                             legend.position = 'top', legend.title=element_blank()) 
print(fig4)

##save to computer
#ggsave("Figure 2 OTR max regions.png", width=8, height=6, dpi=600)

```


>-Where did we see binding for OTR 

>-Where did we see binding for V1aR 

>-Sex differences 

>-Predict with PCA 




# Discussion 


>-We found OTR in … V1aR in…. 

>-Sex differences in densities/presence and absence 

>-We found that overall patterns were similar to….. 

>-Caveats 

>>-Unknown age 

>>-Unknown reproductive status 

>>-Different experiences possible 

>-What this means, similarities to other species 

>-Relevance for behavior or life history 

What still needs to be known? 


References {#references .unnumbered}
==========
